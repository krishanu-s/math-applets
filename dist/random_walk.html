<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>random walk demo</title>
        <base href="." />
        <script>
            MathJax = {
                tex: {
                    inlineMath: { "[+]": [["$", "$"]] },
                },
            };
        </script>
        <script
            defer
            src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"
        ></script>
        <script type="module" src="random_walk_scene.js"></script>
        <style>
            .applet-container {
                display: flex;
                align-items: center; /* Centers vertically */
                width: 50%; /* A width less than 100% is required */
                margin-left: auto;
                margin-right: auto;
                padding: 20px;
                text-align: center;
                font-family: Arial, sans-serif;
            }
            .slider {
                display: flex;
                justify-content: center; /* Centers horizontally */
                align-items: center; /* Centers vertically */
                width: 40%;
                height: 25px;
                margin: 20px 0;
                margin-left: auto;
                margin-right: auto;
            }
        </style>
    </head>

    <body>
        <div style="text-align: center; margin: 10px auto">
            <h1>Random Walks in Two and Three Dimensions</h1>
            <h3>References</h3>
            <ul>
                <li>
                    <a
                        href="https://en.wikipedia.org/wiki/Random_walk#Higher_dimensions"
                        >Random Walks</a
                    >
                </li>
                <li>
                    <a
                        href="https://mathworld.wolfram.com/PolyasRandomWalkConstants.html"
                        >Polya's Random Walk Constants</a
                    >
                </li>
            </ul>

            <h2>Introduction</h2>

            <p>
                Imagine a particle moving randomly on an infinite square grid.
                The particle begins at some initial point $P$, and at each time
                step it moves to one of its four neighboring points each with
                equal probability $\frac{1}{4}$. This is an example of a
                <b>random walk</b>. Consider the following question: assuming
                this random walk is allowed to proceed forever,
                <i>
                    what is the probability that the particle, at some point,
                    revisits its starting point $P$?</i
                >
            </p>

            <div class="applet-container" id="2d-random-walk"></div>
            <div class="button" id="2d-random-walk-pause-button"></div>

            <p>
                We can simplify the model above and consider instead a
                one-dimensional grid, i.e. a line. In this case, the particle
                can only move left or right, each with probability
                $\frac{1}{2}$.
            </p>

            <div class="applet-container" id="1d-random-walk"></div>
            <div class="button" id="1d-random-walk-pause-button"></div>

            <p>
                This model can be more easily related to some real scenarios.
                For example, you could imagine repeatedly flipping a fair coin
                in a gambling scenario. A heads means that you gain \$1, and a
                tails means that you lose \$1. A famous theorem says that if you
                continue this game indefinitely (starting with a finite amount
                of money), you will eventually go bankrupt. (See
                <a href="https://en.wikipedia.org/wiki/Gambler%27s_ruin"
                    >gambler's ruin</a
                >.) This is similar to the statement that a random walk on a
                one-dimensional grid always eventually returns to its starting
                point, which turns out to be true.
            </p>

            <p>
                It turns out that a random walk on a two-dimensional grid always
                eventually returns to its starting point, meaning that the
                answer to the initial question is 100%. However, on a
                <i>three-dimensional</i> grid, the probability of returning to
                the starting point drops to roughly 34%. At four, five, and six
                dimensions, the probability drops to 19.3%, 13.5%, and 10.4%,
                respectively.
            </p>

            <div class="applet-container" id="3d-random-walk"></div>
            <div class="button" id="3d-random-walk-pause-button"></div>

            <p>
                <b>Why?</b> Intuitively, the drop in probability makes sense. In
                higher dimensions, there are more degrees of freedom to move
                around, so the probability of returning to the starting point
                decreases. But why is there a sudden phase transition between
                dimensions 2 and 3? And how does one calculate the percentage
                values above? Lastly, <b>how long</b> does it take for a random
                walk to return to its starting point?
            </p>

            <p>
                An additional surprising result is the following. Although a
                random walk on a one-dimensional or two-dimensional grid always
                returns to its starting point, the
                <i>expected number of steps</i> to do so is infinite. Why?
            </p>

            <p>
                The core goals of this page are to develop an intuitive
                understanding of the phase transition between dimensions 2 and
                3, and for the infinite expected return time. We'll introduce
                some mathematical tools which enable precise calculation. We
                also will explore
                <b>Brownian motion</b>, which is a continuous-analogue of random
                walks which makes some appearances in nature.
            </p>

            <h2>Modeling a random walk with generating functions</h2>
            <p>TODO</p>

            <h2>The normal distribution and Brownian motion</h2>
            <p>TODO Explain how to define Brownian motion</p>

            <h1>Below: Demonstrations</h1>

            <h2>Brownian motion</h2>

            <p>Brownian motion in the plane, set against a pair of axis.</p>
            <br />

            <div class="applet-container" id="brownian-motion-2d"></div>
            <div class="button" id="brownian-motion-2d-pause-button"></div>

            <br />

            <p>Brownian motion in 3D space.</p>
            <br />

            <div class="applet-container" id="brownian-motion-3d"></div>
            <div class="button" id="brownian-motion-3d-pause-button"></div>

            <h2>Histogram</h2>
            <p>
                Here, simulation runs are shown for many random walks in
                $\mathbb{Z}^D$ beginning at the origin, for dimensions $D=2$ and
                $D=3$. A random walk stops if it ever reaches the origin again.
                A histogram is given, showing the distribution of the current
                $L^1$-distance from the origin (distance from the origin shown
                along the x-axis, percentage of walks with that distance shown
                along the y-axis).
            </p>
            <br />

            <div class="applet-container" id="histogram-dim-one"></div>
            <div class="applet-container" id="histogram-dim-two"></div>
            <div class="applet-container" id="histogram-dim-three"></div>
            <div class="applet-container" id="histogram-dim-four"></div>
            <div class="button" id="random-walk-pause-button"></div>
            <br />
            <h2>Proof of the theorem</h2>
            <p>
                Below is a sketch of the proof of the following fact. Consider a
                random walk in $\mathbb{Z}^D$ beginning at the origin, for some
                dimension $D \ge 1$. At each timestep, the walk moves to one of
                the $2D$ neighboring points with equal probability. Then, the
                probability that the walk <i>never</i> returns to the origin is
                (a) zero if $D=1$ or $D=2$, and (b) positive if $D > 2$.
            </p>
            <p>
                Let $a_n$ denote the number of paths of length $n$ in
                $\mathbb{Z}^D$ which begin and end at the origin. Let $b_n$
                denote the number of such paths which never touch the origin
                between the start and end points. Let $$A(t) = 1 + a_1t + a_2t^2
                + a_3t^3 + \cdots$$ $$B(t) = b_1t + b_2t^2 + b_2t^3 +\cdots$$ be
                the generating functions for $a_n$ and $b_n$, respectively. By
                convention, let $a_0=1$ and $b_0=0$.
            </p>
            <p>
                <b>First,</b> the probability that a random walk returns to the
                origin after <i>exactly</i> $n$ steps is equal to $b_n(1/2D)^n$.
                So the probability that a random walk returns to the origin
                after a finite number of steps is equal to $B(1/2D)$.
            </p>
            <p>
                <b>Second,</b> we have the identity $$A(t) = 1 + B(t) + B(t)^2 +
                \ldots = \frac{1}{1-B(t)}$$ This follows from a combinatorial
                argument. From this identity, it follows that $B(1/2D) = 1 -
                \frac{1}{A(1/2D)}$.
            </p>
            <p>
                <b>Third,</b> consider the $(D+1)$-variable generating function
                $$F(x_1, x_2, \ldots, x_D, t) =1 + (x_1 + x_1^{-1} + \ldots +
                x_D + x_D^{-1})t + (x_1 + x_1^{-1} + \ldots + x_D +
                x_D^{-1})^2t^2 + \ldots$$ $$=\frac{1}{1-(x_1 + x_1^{-1} + \ldots
                + x_D + x_D^{-1})t}$$ The coefficient of
                $x_1^{c_1}x_2^{c_2}\ldots x_d^{c_D}t^n$ in this generating
                function is equal to the number of paths of length $n$ which end
                at the point $(c_1, c_2, \ldots, c_D)$. It then follows that
                $a_n$ is the coefficient of $x_1^0x_2^0\ldots x_d^0t^n$ in
                $F(x_1, x_2, \ldots, x_D, t)$.
            </p>
            <p>
                The coefficient of $z^0$ in a generating function $f(z)$ can be
                computed using the complex contour integral $$[z^0]f(z) =
                \frac{1}{2\pi i}\oint_{|z|=1}\frac{f(z)}{z}dz =
                \frac{1}{2\pi}\int\limits_{0}^{2\pi i}f(e^{i\theta})d\theta$$
                The second step above comes from the substitution
                $z=e^{i\theta}$. We apply this for all of the $x_k$'s, letting
                $x_k=e^{i\theta_k}$, and noting that $x_k + x_k^{-1} =
                2\cos(\theta_k)$. We retrieve the entire function $A(t)$ as an
                integral $$A(t) =\left(\frac{1}{2\pi
                }\right)^D\int\limits_{[0,2\pi]^D}F(e^{i\theta_1}, \ldots,
                e^{i\theta_D}, t)d\theta_1\ldots d\theta_D = \left(\frac{1}{2\pi
                }\right)^D\int\limits_{[0,2\pi]^D}\frac{1}{1-2(\cos(\theta_1) +
                \ldots + \cos(\theta_D))t}d\theta_1\ldots d\theta_D$$ Therefore,
                $$A(1/2D) = \left(\frac{1}{2\pi
                }\right)^D\int\limits_{[0,2\pi]^D}\frac{1}{1-(\cos(\theta_1) +
                \ldots + \cos(\theta_D))/D}d\theta_1\ldots d\theta_D$$
            </p>
            <p>
                We claim that the above integral diverges when $D \le 2$
                (implying that $1-\frac{1}{A(1/2D)} = 1$, and therefore any path
                returns to the origin in finite time with probability 1) and
                converges when $D > 2$ (implying that $1-\frac{1}{A(1/2D)} < 1$,
                and therefore there is a nonzero probability that a path never
                returns to the origin). Why is this claim true? (TODO
                Visualization in 2D, and explanation in terms of Taylor
                expansion of cosine.)
            </p>
        </div>
        <a href="./index.html">back to main page</a>
        <br />
        <a href="https://www.ksankar.me">back to Krishanu Sankar's homepage</a>
    </body>
</html>
